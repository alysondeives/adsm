#!/bin/bash

CMAKE=cmake
CMAKE_HOME=`dirname $0`
SCRIPT_NAME=`basename $0`

BUILD_TYPE="Release"

for i in $*
do
    case $i in
    --enable-debug)
        BUILD_TYPE="Debug"
        ;;
    --enable-tests)
        CMAKE_ARGS="${CMAKE_ARGS} -DMAKE_TESTS=ON"
        ;;
    --enable-opencl)
        CMAKE_ARGS="${CMAKE_ARGS} -DUSE_OPENCL=ON"
        ;;
    --enable-doc)
        CMAKE_ARGS="${CMAKE_ARGS} -DMAKE_DOC=ON"
        ;;
    --enable-vm)
        CMAKE_ARGS="${CMAKE_ARGS} -DUSE_VM=ON"
        ;;
    --enable-paraver)
        CMAKE_ARGS="${CMAKE_ARGS} -DUSE_PARAVER=ON"
        ;;
    --with-vm-size=*)
        size=`echo $i | sed 's/[-a-zA-Z0-9]*=//'`
        CMAKE_ARGS="${CMAKE_ARGS} -DVM_BITMAP=${size}"
        ;;
    esac
done

CMAKE_ARGS="${CMAKE_ARGS} -DCMAKE_BUILD_TYPE=${BUILD_TYPE}"
COMMAND="${CMAKE} ${CMAKE_ARGS} ${CMAKE_HOME}"
echo ${COMMAND} > ${SCRIPT_NAME}.log
${COMMAND}
